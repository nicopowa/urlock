/**
 * Nico Pr â€” https://nicopr.fr
 * URLOCK PACKAGE RELEASE v0.2.5
 * 28/11/2025 18:40:10
 */
(function(){async function m(a){if((a.i||a.h||a.g.u.reportValidity())&&a.g.m.reportValidity()){var b=a.g.m.value,f=location.hash.replace(/^#/,"");try{if(a.i){const c=Uint8Array.fromBase64(f,a.C),g=c.slice(16,28),h=c.slice(28),k=await n(b,c.slice(0,16)),e=await crypto.subtle.decrypt({name:"AES-GCM",iv:g},k,h),d=await p(e,DecompressionStream);if(d[0]===0&&d[1]===70&&d[2]===0){const l=d.indexOf(10);l>-1&&(a.h={o:(new TextDecoder).decode(d.slice(3,l)),l:d.slice(l+1)},q(a))}else a.g.u.value=(new TextDecoder).decode(d);
a.g.v.classList.add("res");location.hash="";a.g.m.value=""}else{let c;if(a.h){const e=(new TextEncoder).encode(`\0F\0${a.h.o}\n`);c=new Uint8Array(e.length+a.h.l.length);c.set(e,0);c.set(a.h.l,e.length)}else c=(new TextEncoder).encode(a.g.u.value);const g=crypto.getRandomValues(new Uint8Array(16)),h=crypto.getRandomValues(new Uint8Array(12)),k=Promise.all([p(c,CompressionStream),n(b,g)]).then(([e,d])=>crypto.subtle.encrypt({name:"AES-GCM",iv:h},d,e)).then(e=>{const d=new Uint8Array(28+e.byteLength);
d.set(g,0);d.set(h,16);d.set(new Uint8Array(e),28);return`${location.origin}${location.pathname}#${d.toBase64(a.C)}`});await navigator.clipboard.write([new ClipboardItem({[a.D.type]:k.then(e=>new Blob([e],a.D))})]);await k;a.info("copied")}}catch(c){console.error(c),a.info("error")}}}function r(a,b){const f=new FileReader;f.onload=c=>{a.h={o:b.name,l:new Uint8Array(c.target.result),H:b.size};q(a)};f.readAsArrayBuffer(b)}
function q(a){a.g.v.classList.add("bin");const b=a.h.H||a.h.l.length;a.g.G.innerText=`${a.h.o}\n${b>1048576?(b/1048576).toFixed(2)+"MB":(b/1024).toFixed(2)+"KB"}`;a.g.A.innerText=a.i?"save":"clear";a.g.A.onclick=a.i?()=>{const f=URL.createObjectURL(new Blob([a.h.l])),c=document.createElement("a");c.href=f;c.download=a.h.o;c.click();URL.revokeObjectURL(f)}:()=>{a.h=null;a.g.B.value="";a.g.v.classList.remove("bin")}}
async function n(a,b){return crypto.subtle.deriveKey({name:"PBKDF2",salt:b,iterations:256E3,hash:"SHA-256"},await crypto.subtle.importKey("raw",(new TextEncoder).encode(a),"PBKDF2",!1,["deriveKey"]),{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function p(a,b){return new Uint8Array(await (new Response((new Response(a)).body.pipeThrough(new b("gzip")))).arrayBuffer())}
class t{constructor(){this.g=Object.entries({v:"wrp",I:"row",m:"pwd",j:"btn",u:"txt",G:"nfo",A:"act",B:"fin"}).reduce((a,[b,f])=>({...a,[b]:document.querySelector("#"+f)}),{});this.C={alphabet:"base64url"};this.D={type:"text/plain"};this.F=0;this.h=null;this.i=!!location.hash.replace(/^#/,"");this.g.v.className=this.i?"dec":"enc";this.g.j.innerText=this.i?"decrypt":"encrypt";this.g.j.addEventListener("click",()=>m(this));this.g.m.addEventListener("keydown",a=>a.key==="Enter"&&m(this));this.i?this.g.m.focus():
(this.g.B.addEventListener("change",a=>a.target.files[0]&&r(this,a.target.files[0])),document.body.addEventListener("dragover",a=>{a.preventDefault();a.dataTransfer.dropEffect="copy"}),document.body.addEventListener("drop",a=>{a.preventDefault();a.dataTransfer.files[0]&&r(this,a.dataTransfer.files[0])}),this.g.u.focus())}info(a){clearTimeout(this.F);const b=this.g.j.innerText;this.g.j.innerText=a;this.F=setTimeout(()=>this.g.j.innerText=b,2345)}}window.onload=()=>new t;}).call(this);
